{"version":3,"sources":["components/Tree/Tree.tsx"],"names":["treeBehavior","useTelemetry","useUnhandledProps","getElementType","useAccessibility","useStyles","useFluentContext","customPropTypes","PropTypes","React","TreeItem","TreeTitle","childrenExist","commonPropTypes","createShorthandFactory","rtlTextContainer","useTree","TreeContext","treeClassName","Tree","forwardRef","props","ref","context","displayName","telemetry","setStart","setEnd","selectable","children","renderedItems","className","design","styles","variables","ElementType","unhandledProps","handledProps","getA11yProps","accessibility","debugName","rtl","mapPropsToBehavior","mapPropsToInlineStyles","classes","visibleItemIds","getItemById","registerItemRef","toggleItemActive","focusItemById","expandSiblings","toggleItemSelect","getToFocusIDByFirstCharacter","contextValue","useMemo","renderContent","map","id","item","expanded","parent","level","index","treeSize","create","defaultProps","renderItemTitle","overrideProps","key","element","unstable_wrapWithFocusZone","root","getAttributes","forElements","propTypes","createCommon","content","activeItemIds","collectionShorthand","selectedItemIds","defaultActiveItemIds","defaultSelectedItemIds","exclusive","bool","items","collectionObjectShorthand","onActiveItemIdsChange","func","onSelectedItemIdsChange","Item","Title","Object","keys","Component","mappedArrayProp"],"mappings":"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","sourcesContent":["import { Accessibility, treeBehavior, TreeBehaviorProps } from '@fluentui/accessibility';\nimport {\n  useTelemetry,\n  useUnhandledProps,\n  getElementType,\n  useAccessibility,\n  useStyles,\n  useFluentContext,\n  ForwardRefWithAs,\n} from '@fluentui/react-bindings';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { TreeItem, TreeItemProps } from './TreeItem';\nimport { TreeTitle, TreeTitleProps } from './TreeTitle';\nimport {\n  childrenExist,\n  commonPropTypes,\n  createShorthandFactory,\n  UIComponentProps,\n  ChildrenComponentProps,\n  rtlTextContainer,\n} from '../../utils';\nimport {\n  ComponentEventHandler,\n  ObjectShorthandCollection,\n  FluentComponentStaticProps,\n  ShorthandRenderFunction,\n} from '../../types';\nimport { useTree } from './hooks/useTree';\nimport { TreeContext, TreeRenderContextValue } from './context';\n\nexport interface TreeProps extends UIComponentProps, ChildrenComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<TreeBehaviorProps>;\n\n  /** Ids of expanded items. */\n  activeItemIds?: string[];\n\n  /** Ids of selected leaf items. */\n  selectedItemIds?: string[];\n\n  /** Initial activeItemIds value. */\n  defaultActiveItemIds?: string[];\n\n  /** Initial selectedItemIds value. */\n  defaultSelectedItemIds?: string[];\n\n  /** Only allow one subtree to be expanded at a time. */\n  exclusive?: boolean;\n\n  /** Shorthand array of props for Tree. */\n  items?: ObjectShorthandCollection<TreeItemProps>;\n\n  /**\n   * A custom render function for the title slot.\n   *\n   * @param Component - The computed component for this slot.\n   * @param props - The computed props for this slot.\n   * @param children - The computed children for this slot.\n   */\n  renderItemTitle?: ShorthandRenderFunction<TreeTitleProps>;\n\n  /**\n   * Called when active item ids change.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props, with `activeItemIds` reflecting the new state.\n   */\n  onActiveItemIdsChange?: ComponentEventHandler<TreeProps>;\n\n  /**\n   * Called when tree item selection state is changed.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props, with `selectedItemIds` reflecting the new state.\n   */\n  onSelectedItemIdsChange?: ComponentEventHandler<TreeProps>;\n\n  /**\n   * Callback that provides rendered tree items to be used by react-virtualized for instance.\n   * Acts as a render prop, with the rendered tree items being the re-used logic.\n   *\n   * @param renderedItem - The array of rendered items.\n   * @returns The render prop result.\n   */\n  renderedItems?: (renderedItems: React.ReactElement[]) => React.ReactNode;\n\n  /** Whether or not tree items are selectable. */\n  selectable?: boolean;\n}\n\nexport const treeClassName = 'ui-tree';\n\nexport type TreeStylesProps = never;\n\n/**\n * A Tree displays data organised in tree hierarchy.\n *\n * @accessibility\n * Implements [ARIA TreeView](https://www.w3.org/TR/wai-aria-practices-1.1/#TreeView) design pattern.\n * @accessibilityIssues\n * [Treeview - JAWS doesn't narrate position for each tree item](https://github.com/FreedomScientific/VFO-standards-support/issues/338)\n * [Aria-selected and aria-checked are not output correctly for trees #432](https://github.com/FreedomScientific/VFO-standards-support/issues/432)\n * [Aria compliant trees are read as empty tables](https://bugs.chromium.org/p/chromium/issues/detail?id=1048770)\n * [VoiceOver narrates \"selected false\" for DOM with role=option and no aria-selected attribute](http://www.openradar.me/FB8050959)\n * [VoiceOver does not support Aria 1.2 listbox role owning unselectable group role](http://www.openradar.me/FB8050958)\n * [Tree as table in Mac > VoiceOver narrates \" no selection \" when user navigates to tree/table](https://bugs.chromium.org/p/chromium/issues/detail?id=1273538)\n * [Tree as table in Mac > VoiceOver narrates \" 0 items enclosed \" when user navigates to expaded treeitem](https://bugs.chromium.org/p/chromium/issues/detail?id=1273540)\n * [Tree as table in Mac > VoiceOver doesn't narrate aria-labelledby element on treeitem](https://bugs.chromium.org/p/chromium/issues/detail?id=1273544)\n */\nexport const Tree = (React.forwardRef<HTMLDivElement, TreeProps>((props, ref) => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Tree.displayName, context.telemetry);\n  setStart();\n\n  const { selectable, children, renderedItems, className, design, styles, variables } = props;\n\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(Tree.handledProps, props);\n\n  const getA11yProps = useAccessibility(props.accessibility, {\n    debugName: Tree.displayName,\n    rtl: context.rtl,\n    mapPropsToBehavior: () => ({\n      selectable,\n    }),\n  });\n\n  const { classes } = useStyles<TreeStylesProps>(Tree.displayName, {\n    className: treeClassName,\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const {\n    visibleItemIds,\n    getItemById,\n    registerItemRef,\n    toggleItemActive,\n    focusItemById,\n    expandSiblings,\n    toggleItemSelect,\n    getToFocusIDByFirstCharacter,\n  } = useTree(props);\n\n  const contextValue: TreeRenderContextValue = React.useMemo(\n    () => ({\n      getItemById,\n      registerItemRef,\n      toggleItemActive,\n      expandSiblings,\n      focusItemById,\n      toggleItemSelect,\n      getToFocusIDByFirstCharacter,\n    }),\n    [\n      getItemById,\n      registerItemRef,\n      toggleItemActive,\n      focusItemById,\n      expandSiblings,\n      toggleItemSelect,\n      getToFocusIDByFirstCharacter,\n    ],\n  );\n\n  const renderContent = (): React.ReactElement[] => {\n    return visibleItemIds.map(id => {\n      const item = getItemById(id);\n      const { expanded, parent, level, index, treeSize } = item;\n      return TreeItem.create(item.item, {\n        defaultProps: () =>\n          getA11yProps('item', {\n            renderItemTitle: props.renderItemTitle,\n          }),\n        overrideProps: {\n          expanded,\n          parent,\n          key: id,\n          level,\n          index,\n          treeSize,\n          selectable: selectable ? item.item.selectable : false,\n        },\n      });\n    });\n  };\n\n  const element = (\n    <TreeContext.Provider value={contextValue}>\n      {getA11yProps.unstable_wrapWithFocusZone(\n        <ElementType\n          {...getA11yProps('root', {\n            className: classes.root,\n            ref,\n            ...rtlTextContainer.getAttributes({ forElements: [children] }),\n            ...unhandledProps,\n          })}\n        >\n          {childrenExist(children) ? children : renderedItems ? renderedItems(renderContent()) : renderContent()}\n        </ElementType>,\n      )}\n    </TreeContext.Provider>\n  );\n  setEnd();\n  return element;\n}) as unknown) as ForwardRefWithAs<'div', HTMLDivElement, TreeProps> &\n  FluentComponentStaticProps<TreeProps> & {\n    Item: typeof TreeItem;\n    Title: typeof TreeTitle;\n  };\n\nTree.displayName = 'Tree';\n\nTree.propTypes = {\n  ...commonPropTypes.createCommon({\n    content: false,\n  }),\n  activeItemIds: customPropTypes.collectionShorthand,\n  selectedItemIds: customPropTypes.collectionShorthand,\n  defaultActiveItemIds: customPropTypes.collectionShorthand,\n  defaultSelectedItemIds: customPropTypes.collectionShorthand,\n  exclusive: PropTypes.bool,\n  selectable: PropTypes.bool,\n  items: customPropTypes.collectionObjectShorthand,\n  onActiveItemIdsChange: PropTypes.func,\n  onSelectedItemIdsChange: PropTypes.func,\n  renderItemTitle: PropTypes.func,\n  renderedItems: PropTypes.func,\n};\n\nTree.Item = TreeItem;\nTree.Title = TreeTitle;\n\nTree.defaultProps = {\n  accessibility: treeBehavior,\n};\n\nTree.handledProps = Object.keys(Tree.propTypes) as any;\n\nTree.create = createShorthandFactory({\n  Component: Tree,\n  mappedArrayProp: 'items',\n});\n"],"file":"Tree.js"}