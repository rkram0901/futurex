{"version":3,"sources":["components/Chat/ChatMessage.tsx"],"names":["chatMessageClassName","chatMessageSlotClassNames","actionMenu","author","badge","bar","compactBody","content","reactionGroup","timestamp","partitionActionMenuPropsFromShorthand","value","Array","isArray","inline","showActionMenu","props","ChatMessage","React","forwardRef","inputProps","ref","context","displayName","telemetry","setStart","setEnd","parentAttached","ChatItemContext","v","attached","chatProps","density","accessibility","behaviors","message","undefined","chatMessageBehavior","badgePosition","children","className","design","details","header","mine","positionActionMenu","reactionGroupPosition","readStatus","styles","overflow","unstable_overflow","variables","actionMenuOptions","positioningProps","inlineActionMenu","controlledShowActionMenu","defaultValue","setShowActionMenu","hasActionMenu","hasHeaderReactionGroup","actionMenuId","useRef","current","modifiers","useCallback","target","container","name","options","fallbackPlacements","boundary","popperRef","align","position","positionFixed","enabled","messageRef","targetRef","actionsMenuRef","containerRef","useState","focused","setFocused","getA11Props","actionHandlers","preventDefault","event","currentTarget","focus","stopPropagation","debugName","mapPropsToBehavior","rtl","mapPropsToStyles","hasBadge","mapPropsToInlineStyles","classes","resolvedStyles","handleFocus","e","updatePosition","handleBlur","shouldPreserveFocusState","relatedTarget","handleMouseEnter","handleMouseLeave","renderActionMenu","actionMenuElement","Menu","create","defaultProps","IS_FOCUSABLE_ATTRIBUTE","menuAsToolbarBehavior","overrideProps","id","handleKeyDown","toFocusItemInActionMenu","querySelector","querySelectorAll","keyCode","keyboardKey","Enter","Tab","isShift","shiftKey","focusableElementsInsideMessage","firstFocusableInsideMessage","lastFocusableInsideMessage","length","boundaryElementInsideMessage","childrenPropExists","rootClasses","root","ElementType","unhandledProps","handledProps","badgeElement","Label","reactionGroupElement","Reaction","Group","authorElement","Text","size","timestampElement","messageContent","Box","detailsElement","ChatMessageDetails","readStatusElement","ChatMessageReadStatus","elements","headerElement","ChatMessageHeader","bodyElement","element","unstable_wrapWithFocusZone","onBlur","onFocus","onMouseEnter","onMouseLeave","onKeyDown","rtlTextContainer","getAttributes","forElements","propTypes","commonPropTypes","createCommon","PropTypes","oneOfType","customPropTypes","itemShorthand","collectionShorthand","bool","oneOf","func","Object","keys","Component","mappedProp"],"mappings":"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","sourcesContent":["import {\n  Accessibility,\n  chatMessageBehavior,\n  ChatMessageBehaviorProps,\n  IS_FOCUSABLE_ATTRIBUTE,\n  keyboardKey,\n  menuAsToolbarBehavior,\n} from '@fluentui/accessibility';\nimport {\n  getElementType,\n  useAccessibility,\n  useAutoControlled,\n  useContextSelector,\n  useFluentContext,\n  useStyles,\n  useTelemetry,\n  useUnhandledProps,\n  useMergedRefs,\n  ForwardRefWithAs,\n} from '@fluentui/react-bindings';\nimport { Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport cx from 'classnames';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  ComponentEventHandler,\n  ComponentKeyboardEventHandler,\n  FluentComponentStaticProps,\n  ObjectShorthandValue,\n  ShorthandCollection,\n  ShorthandValue,\n} from '../../types';\nimport {\n  ChildrenComponentProps,\n  childrenExist,\n  commonPropTypes,\n  ContentComponentProps,\n  createShorthand,\n  createShorthandFactory,\n  getOrGenerateIdFromShorthand,\n  rtlTextContainer,\n  UIComponentProps,\n} from '../../utils';\nimport {\n  getScrollParent,\n  partitionPopperPropsFromShorthand,\n  PopperModifiersFn,\n  PopperRefHandle,\n  PopperShorthandProps,\n  usePopper,\n} from '../../utils/positioner';\nimport { Box, BoxProps } from '../Box/Box';\nimport { Flex } from '../Flex/Flex';\nimport { Label, LabelProps } from '../Label/Label';\nimport { Menu, MenuProps } from '../Menu/Menu';\nimport { MenuItemProps } from '../Menu/MenuItem';\nimport { PortalInner } from '../Portal/PortalInner';\nimport { Reaction, ReactionProps } from '../Reaction/Reaction';\nimport { ReactionGroupProps } from '../Reaction/ReactionGroup';\nimport { Text, TextProps } from '../Text/Text';\nimport { useChatContextSelectors } from './chatContext';\nimport { ChatDensity } from './chatDensity';\nimport { ChatItemContext } from './chatItemContext';\nimport { ChatMessageDetails, ChatMessageDetailsProps } from './ChatMessageDetails';\nimport { ChatMessageHeader, ChatMessageHeaderProps } from './ChatMessageHeader';\nimport { ChatMessageReadStatus, ChatMessageReadStatusProps } from './ChatMessageReadStatus';\n\nexport interface ChatMessageSlotClassNames {\n  actionMenu: string;\n  author: string;\n  badge: string;\n  bar: string;\n  compactBody: string;\n  content: string;\n  reactionGroup: string;\n  timestamp: string;\n}\n\nexport interface ChatMessageProps\n  extends UIComponentProps,\n    ChildrenComponentProps,\n    ContentComponentProps<ShorthandValue<BoxProps>> {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<ChatMessageBehaviorProps>;\n\n  /**\n   * Menu with actions of the message.\n   * popper: alters the action menu positioning.\n   * inline: whether the action menu should be rendered inline with the chat message, or in the body. It's true by default.\n   * showActionMenu: controls if the action menu is visible or not.\n   */\n  actionMenu?:\n    | ShorthandValue<MenuProps & { popper?: PopperShorthandProps; inline?: boolean; showActionMenu?: boolean }>\n    | ShorthandCollection<MenuItemProps & { inline?: boolean; showActionMenu?: boolean }>;\n\n  /** Controls messages's relation to other chat messages. Is automatically set by the ChatItem. */\n  attached?: boolean | 'top' | 'bottom';\n\n  /** Author of the message. */\n  author?: ShorthandValue<TextProps>;\n\n  /** Badge attached to the message. */\n  badge?: ShorthandValue<LabelProps>;\n\n  /** A message can format the badge to appear at the start or the end of the message. */\n  badgePosition?: 'start' | 'end';\n\n  /** A message can have a custom body. Only rendered in compact density. */\n  compactBody?: ShorthandValue<BoxProps>;\n\n  /** Chat density. Is automatically set by the Chat. */\n  density?: ChatDensity;\n\n  /** Message details info slot. Displayed in the header or body in comfy and compact density respectively. */\n  details?: ShorthandValue<ChatMessageDetailsProps>;\n\n  /** A message can have a custom header. */\n  header?: ShorthandValue<ChatMessageHeaderProps>;\n\n  /** Indicates whether message belongs to the current user. */\n  mine?: boolean;\n\n  /**\n   * Called after user's blur.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onBlur?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user's focus.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onFocus?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called on chat message item key down.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onKeyDown?: ComponentKeyboardEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user enters by mouse.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onMouseEnter?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user leaves by mouse.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onMouseLeave?: ComponentEventHandler<ChatMessageProps>;\n\n  /** Allows suppression of action menu positioning for performance reasons. */\n  positionActionMenu?: boolean;\n\n  /** Reaction group applied to the message. */\n  reactionGroup?: ShorthandValue<ReactionGroupProps> | ShorthandCollection<ReactionProps>;\n\n  /** A message can format the reactions group to appear at the start or the end of the message. */\n  reactionGroupPosition?: 'start' | 'end';\n\n  /** Message read status indicator. */\n  readStatus?: ShorthandValue<ChatMessageReadStatusProps>;\n\n  /** Timestamp of the message. */\n  timestamp?: ShorthandValue<TextProps>;\n\n  /** Positions an actionMenu slot in \"fixed\" mode. */\n  unstable_overflow?: boolean;\n}\n\nexport type ChatMessageStylesProps = Pick<ChatMessageProps, 'attached' | 'badgePosition' | 'density' | 'mine'> & {\n  hasBadge: boolean;\n  hasHeaderReactionGroup: boolean;\n\n  // focused, hasActionMenu and showActionMenu controls the visibility of action menu\n  focused: boolean;\n  hasActionMenu: boolean;\n  showActionMenu: boolean;\n};\n\nexport const chatMessageClassName = 'ui-chat__message';\nexport const chatMessageSlotClassNames: ChatMessageSlotClassNames = {\n  actionMenu: `${chatMessageClassName}__actions`,\n  author: `${chatMessageClassName}__author`,\n  badge: `${chatMessageClassName}__badge`,\n  bar: `${chatMessageClassName}__bar`,\n  compactBody: `${chatMessageClassName}__compact-body`,\n  content: `${chatMessageClassName}__content`,\n  reactionGroup: `${chatMessageClassName}__reactions`,\n  timestamp: `${chatMessageClassName}__timestamp`,\n};\n\nfunction partitionActionMenuPropsFromShorthand<P>(\n  value: ShorthandValue<P & { inline?: boolean; showActionMenu?: boolean }>,\n): [ShorthandValue<P> | ObjectShorthandValue<P>, boolean | undefined, boolean | undefined] {\n  if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n    const { inline, showActionMenu, ...props } = value as ObjectShorthandValue<P> & {\n      inline?: boolean;\n      showActionMenu?: boolean;\n    };\n\n    return [props as ObjectShorthandValue<P>, inline ?? true, showActionMenu];\n  }\n\n  return [value, true, false];\n}\n\n/**\n * A ChatMessage represents a single message in chat.\n */\nexport const ChatMessage = (React.forwardRef<HTMLDivElement, ChatMessageProps>((inputProps, ref) => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(ChatMessage.displayName, context.telemetry);\n  setStart();\n\n  const parentAttached = useContextSelector(ChatItemContext, v => v.attached);\n  const chatProps = useChatContextSelectors({\n    density: v => v.density,\n    accessibility: v => v.behaviors.message,\n  });\n\n  const props = {\n    ...inputProps,\n    density: inputProps.density === undefined ? chatProps.density : inputProps.density,\n    accessibility:\n      inputProps.accessibility === undefined\n        ? chatProps.accessibility || chatMessageBehavior\n        : inputProps.accessibility,\n  };\n  const {\n    accessibility,\n    attached = parentAttached,\n    author,\n    badge,\n    badgePosition,\n    children,\n    className,\n    compactBody,\n    content,\n    density,\n    design,\n    details,\n    header,\n    mine,\n    positionActionMenu,\n    reactionGroup,\n    reactionGroupPosition,\n    readStatus,\n    styles,\n    timestamp,\n    unstable_overflow: overflow,\n    variables,\n  } = props;\n\n  const [actionMenuOptions, positioningProps] = partitionPopperPropsFromShorthand(props.actionMenu);\n  const [actionMenu, inlineActionMenu, controlledShowActionMenu] = partitionActionMenuPropsFromShorthand(\n    actionMenuOptions,\n  );\n  const [showActionMenu, setShowActionMenu] = useAutoControlled<boolean>({\n    defaultValue: false,\n    value: controlledShowActionMenu,\n  });\n  const hasActionMenu = !_.isNil(actionMenu);\n  const hasHeaderReactionGroup = !!reactionGroup && reactionGroupPosition === 'start';\n\n  const actionMenuId = React.useRef<string>();\n  actionMenuId.current = getOrGenerateIdFromShorthand(`${chatMessageClassName}-`, actionMenu, actionMenuId.current);\n\n  const modifiers = React.useCallback<PopperModifiersFn>(\n    (target, container) => {\n      return (\n        positionActionMenu && [\n          // https://popper.js.org/docs/v2/modifiers/flip/\n          // Forces to flip only in \"top-*\" positions\n          { name: 'flip', options: { fallbackPlacements: ['top'] } },\n          overflow && {\n            name: 'preventOverflow',\n            options: { boundary: getScrollParent(container) },\n          },\n        ]\n      );\n    },\n    [positionActionMenu, overflow],\n  );\n\n  const popperRef = React.useRef<PopperRefHandle>();\n  const { targetRef: messageRef, containerRef: actionsMenuRef } = usePopper({\n    align: 'end',\n    position: 'above',\n    positionFixed: overflow,\n\n    enabled: hasActionMenu && positionActionMenu,\n    modifiers,\n\n    ...positioningProps,\n    popperRef: useMergedRefs(positioningProps?.popperRef, popperRef),\n  });\n\n  // `focused` state is used for show/hide actionMenu\n  const [focused, setFocused] = React.useState<boolean>(false);\n\n  const getA11Props = useAccessibility(accessibility, {\n    actionHandlers: {\n      // prevents default FocusZone behavior, e.g., in ChatMessageBehavior, it prevents FocusZone from using arrow keys\n      // as navigation (only Tab key should work)\n      preventDefault: event => {\n        // preventDefault only if event coming from inside the message\n        if (event.currentTarget !== event.target) {\n          event.preventDefault();\n        }\n      },\n\n      focus: event => {\n        if (messageRef.current) {\n          messageRef.current.focus();\n          event.stopPropagation();\n        }\n      },\n    },\n    debugName: ChatMessage.displayName,\n    mapPropsToBehavior: () => ({\n      hasActionMenu,\n      inlineActionMenu,\n      actionMenuId: actionMenuId.current,\n    }),\n    rtl: context.rtl,\n  });\n\n  const { classes, styles: resolvedStyles } = useStyles<ChatMessageStylesProps>(ChatMessage.displayName, {\n    className: chatMessageClassName,\n    mapPropsToStyles: () => ({\n      attached,\n      badgePosition,\n      density,\n      focused,\n      hasActionMenu,\n      hasBadge: !!badge,\n      hasHeaderReactionGroup,\n      mine,\n      showActionMenu,\n    }),\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const handleFocus = (e: React.SyntheticEvent) => {\n    popperRef.current?.updatePosition();\n\n    // react onFocus is called even when nested component receives focus (i.e. it bubbles)\n    // so when focus moves within actionMenu, the `focus` state in chatMessage remains true, and keeps actionMenu visible\n    setFocused(true);\n    _.invoke(props, 'onFocus', e, props);\n  };\n\n  const handleBlur = (e: React.SyntheticEvent) => {\n    // `focused` controls is focused the whole `ChatMessage` or any of its children. When we're navigating\n    // with keyboard the focused element will be changed and there is no way to use `:focus` selector\n    const shouldPreserveFocusState = _.invoke(e, 'currentTarget.contains', (e as any).relatedTarget);\n\n    setFocused(shouldPreserveFocusState);\n    setShowActionMenu(false);\n\n    _.invoke(props, 'onBlur', e, props);\n  };\n\n  const handleMouseEnter = (e: React.SyntheticEvent) => {\n    popperRef.current?.updatePosition();\n    if (hasActionMenu && !inlineActionMenu) {\n      setShowActionMenu(true);\n    }\n    _.invoke(props, 'onMouseEnter', e, props);\n  };\n\n  const handleMouseLeave = (e: React.SyntheticEvent) => {\n    if (!focused && hasActionMenu && !inlineActionMenu) {\n      setShowActionMenu(false);\n    }\n    _.invoke(props, 'onMouseLeave', e, props);\n  };\n\n  const renderActionMenu = () => {\n    const actionMenuElement = Menu.create(actionMenu, {\n      defaultProps: () => ({\n        [IS_FOCUSABLE_ATTRIBUTE]: true,\n        accessibility: menuAsToolbarBehavior,\n        className: chatMessageSlotClassNames.actionMenu,\n        styles: resolvedStyles.actionMenu,\n      }),\n      overrideProps: {\n        id: actionMenuId.current,\n      },\n    });\n\n    const content = actionMenuElement ? <Ref innerRef={actionsMenuRef}>{actionMenuElement}</Ref> : actionMenuElement;\n\n    return inlineActionMenu || !content ? content : <PortalInner>{content}</PortalInner>;\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (hasActionMenu && !inlineActionMenu) {\n      // reference: https://github.com/microsoft/fluentui/pull/17329\n\n      const toFocusItemInActionMenu =\n        actionsMenuRef.current?.querySelector('[tabindex=\"0\"]') ??\n        actionsMenuRef.current?.querySelectorAll('[tabindex=\"-1\"]:not([data-is-focusable=\"false\"])')[0];\n\n      if (e.keyCode === keyboardKey.Enter) {\n        toFocusItemInActionMenu?.focus();\n        e.stopPropagation();\n        e.preventDefault();\n      }\n\n      if (e.keyCode === keyboardKey.Tab) {\n        // TAB/SHIFT+TAB cycles focus among actionMenu and focusable elements within chat message\n        const isShift = !!e.shiftKey;\n\n        const focusableElementsInsideMessage: NodeListOf<HTMLElement> = e.currentTarget.querySelectorAll(\n          '[tabindex=\"-1\"]:not([data-is-focusable=\"false\"])',\n        );\n        const firstFocusableInsideMessage = focusableElementsInsideMessage[0];\n        const lastFocusableInsideMessage = focusableElementsInsideMessage[focusableElementsInsideMessage.length - 1];\n\n        if (e.target === toFocusItemInActionMenu) {\n          // focus is now inside action menu\n          // cycle focus into the first/last focusable element inside chat message\n          if (isShift) {\n            lastFocusableInsideMessage?.focus();\n          } else {\n            firstFocusableInsideMessage?.focus();\n          }\n          e.stopPropagation();\n          e.preventDefault();\n        } else {\n          const boundaryElementInsideMessage = isShift ? firstFocusableInsideMessage : lastFocusableInsideMessage;\n          if (e.target === boundaryElementInsideMessage) {\n            // focus is now on the first/last focusable element inside chat message\n            toFocusItemInActionMenu.focus(); // cycle focus back into action Menu\n            e.stopPropagation();\n            e.preventDefault();\n          }\n        }\n      }\n    }\n    _.invoke(props, 'onKeyDown', e, props);\n  };\n\n  const childrenPropExists = childrenExist(children);\n  const rootClasses = childrenPropExists ? cx(classes.root, classes.content) : classes.root;\n\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(ChatMessage.handledProps, props);\n\n  const badgeElement = Label.create(badge, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.badge,\n      styles: resolvedStyles.badge,\n    }),\n  });\n\n  const reactionGroupElement = Reaction.Group.create(reactionGroup, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.reactionGroup,\n      styles: resolvedStyles.reactionGroup,\n    }),\n  });\n\n  const actionMenuElement = renderActionMenu();\n\n  const authorElement = Text.create(author, {\n    defaultProps: () => ({\n      size: density === 'comfy' ? 'small' : undefined,\n      styles: resolvedStyles.author,\n      className: chatMessageSlotClassNames.author,\n    }),\n  });\n\n  const timestampElement = Text.create(timestamp, {\n    defaultProps: () => ({\n      size: 'small',\n      styles: resolvedStyles.timestamp,\n      timestamp: true,\n      className: chatMessageSlotClassNames.timestamp,\n    }),\n  });\n\n  const messageContent = Box.create(content, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.content,\n      styles: resolvedStyles.content,\n    }),\n  });\n\n  const detailsElement = createShorthand(ChatMessageDetails, details, {\n    defaultProps: () => ({ attached, density, hasHeaderReactionGroup, mine }),\n  });\n\n  const readStatusElement = createShorthand(ChatMessageReadStatus, readStatus, {\n    defaultProps: () => ({ density }),\n  });\n\n  let elements = <></>;\n  if (density === 'compact') {\n    const headerElement = createShorthand(ChatMessageHeader, header);\n\n    const bodyElement = Box.create(compactBody || {}, {\n      defaultProps: () =>\n        getA11Props('compactBody', {\n          className: chatMessageSlotClassNames.compactBody,\n          styles: resolvedStyles.compactBody,\n        }),\n      overrideProps: () => ({\n        content: (\n          <>\n            <Flex.Item grow={1}>\n              <div>\n                {authorElement}\n                {messageContent}\n              </div>\n            </Flex.Item>\n            {timestampElement}\n            {detailsElement}\n            {badgeElement}\n          </>\n        ),\n      }),\n    });\n\n    elements = (\n      <>\n        {actionMenuElement}\n        <div className={chatMessageSlotClassNames.bar} />\n        {headerElement}\n        {bodyElement}\n        {reactionGroupElement}\n        {readStatusElement}\n      </>\n    );\n  } else {\n    const headerElement = createShorthand(ChatMessageHeader, header || {}, {\n      overrideProps: () => ({\n        content: (\n          <>\n            {authorElement}\n            {timestampElement}\n            {detailsElement}\n            {reactionGroupPosition === 'start' && reactionGroupElement}\n          </>\n        ),\n      }),\n    });\n\n    elements = (\n      <>\n        {actionMenuElement}\n        <div className={chatMessageSlotClassNames.bar} />\n        {badgePosition === 'start' && badgeElement}\n        {headerElement}\n        {messageContent}\n        {reactionGroupPosition === 'end' && reactionGroupElement}\n        {badgePosition === 'end' && badgeElement}\n        {readStatusElement}\n      </>\n    );\n  }\n\n  const element = (\n    <Ref innerRef={messageRef}>\n      {getA11Props.unstable_wrapWithFocusZone(\n        <ElementType\n          {...getA11Props('root', {\n            className: rootClasses,\n            onBlur: handleBlur,\n            onFocus: handleFocus,\n            onMouseEnter: handleMouseEnter,\n            onMouseLeave: handleMouseLeave,\n            onKeyDown: handleKeyDown,\n            ref,\n            ...rtlTextContainer.getAttributes({ forElements: [children] }),\n            ...unhandledProps,\n          })}\n        >\n          {childrenPropExists ? children : elements}\n        </ElementType>,\n      )}\n    </Ref>\n  );\n  setEnd();\n\n  return element;\n}) as unknown) as ForwardRefWithAs<'div', HTMLDivElement, ChatMessageProps> &\n  FluentComponentStaticProps<ChatMessageProps>;\n\nChatMessage.displayName = 'ChatMessage';\n\nChatMessage.defaultProps = {\n  badgePosition: 'end',\n  positionActionMenu: true,\n  reactionGroupPosition: 'start',\n};\n\nChatMessage.propTypes = {\n  ...commonPropTypes.createCommon({ content: 'shorthand' }),\n  actionMenu: PropTypes.oneOfType([customPropTypes.itemShorthand, customPropTypes.collectionShorthand]),\n  attached: PropTypes.oneOfType([PropTypes.bool, PropTypes.oneOf<'top' | 'bottom'>(['top', 'bottom'])]),\n  author: customPropTypes.itemShorthand,\n  badge: customPropTypes.itemShorthand,\n  badgePosition: PropTypes.oneOf(['start', 'end']),\n  compactBody: customPropTypes.itemShorthand,\n  density: PropTypes.oneOf<ChatDensity>(['comfy', 'compact']),\n  details: customPropTypes.itemShorthand,\n  header: customPropTypes.itemShorthand,\n  mine: PropTypes.bool,\n  onBlur: PropTypes.func,\n  onFocus: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  positionActionMenu: PropTypes.bool,\n  reactionGroup: PropTypes.oneOfType([customPropTypes.collectionShorthand, customPropTypes.itemShorthand]),\n  reactionGroupPosition: PropTypes.oneOf(['start', 'end']),\n  readStatus: customPropTypes.itemShorthand,\n  timestamp: customPropTypes.itemShorthand,\n  unstable_overflow: PropTypes.bool,\n};\n\nChatMessage.handledProps = Object.keys(ChatMessage.propTypes) as any;\n\nChatMessage.create = createShorthandFactory({ Component: ChatMessage, mappedProp: 'content' });\n"],"file":"ChatMessage.js"}